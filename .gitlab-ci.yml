stages:
  - test-job

test-job:
  stage: test-job
  image: eclipse-temurin:21-jdk
  services:
    - docker:24.0.5-dind
  variables:
    DOCKER_HOST: "tcp://docker:2375"
    DOCKER_TLS_CERTDIR: ""
    DOCKER_DRIVER: overlay2
    TESTCONTAINERS_HOST_OVERRIDE: "docker"
    TESTCONTAINERS_RYUK_DISABLED: "true"
  before_script:
    - apt-get update && apt-get install -y git docker.io libgl1 libfontconfig1 libx11-6
    - chmod +x runClean.sh
    - chmod +x runServerTest.sh
    - chmod +x runComposeAppTest.sh
    - chmod +x runTests.sh
  script:
    - ./runTests.sh